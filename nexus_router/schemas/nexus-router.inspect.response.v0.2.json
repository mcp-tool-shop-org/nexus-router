{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "nexus-router.inspect.response.v0.2",
  "type": "object",
  "additionalProperties": false,
  "required": ["summary", "runs"],
  "properties": {
    "summary": {
      "type": "object",
      "additionalProperties": false,
      "required": ["runs_total", "completed", "failed", "running"],
      "properties": {
        "runs_total": { "type": "integer", "minimum": 0 },
        "completed": { "type": "integer", "minimum": 0 },
        "failed": { "type": "integer", "minimum": 0 },
        "running": { "type": "integer", "minimum": 0 }
      }
    },
    "runs": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "run_id",
          "mode",
          "goal",
          "status",
          "created_at",
          "steps_planned",
          "steps_executed",
          "tools_used",
          "outcome",
          "last_failure_reason"
        ],
        "properties": {
          "run_id": { "type": "string" },
          "mode": { "type": "string", "enum": ["dry_run", "apply"] },
          "goal": { "type": "string" },
          "status": { "type": "string", "enum": ["RUNNING", "COMPLETED", "FAILED"] },
          "created_at": { "type": "string" },
          "steps_planned": { "type": "integer", "minimum": 0 },
          "steps_executed": { "type": "integer", "minimum": 0 },
          "tools_used": {
            "type": "array",
            "items": { "type": "string" }
          },
          "outcome": { "type": ["string", "null"], "enum": ["ok", "error", null] },
          "last_failure_reason": { "type": ["string", "null"] }
        }
      }
    }
  }
}
